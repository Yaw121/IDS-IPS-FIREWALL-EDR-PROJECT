<b>OBJECTIVE</b>

The objective of this project is to design, implement, and analyze a comprehensive network security architecture utilizing Intrusion Detection Systems (IDS), Intrusion Prevention Systems (IPS), Data Loss Prevention (DLP) tools, Endpoint Detection and Response (EDR) solutions, and firewalls. This lab on LetsDefend aims to:

- Simulate real-world attack scenarios to evaluate the effectiveness of IDS/IPS in detecting and preventing malicious activities, including unauthorized access, malware infiltration, and brute force attacks.
- Implement DLP solutions to monitor, detect, and prevent sensitive data exfiltration and enforce organizational compliance policies.
- Deploy EDR solutions to identify and mitigate endpoint threats, ensuring rapid detection and response to suspicious activities across multiple systems.
- Configure and test firewall rules and policies to secure the network perimeter while ensuring proper segmentation and access control.
- Analyze security logs and alerts generated by IDS/IPS, DLP, EDR, and firewall systems to correlate events, identify patterns, and develop actionable insights for threat mitigation.
- Document configurations, findings, and mitigation strategies, providing a structured approach to securing enterprise environments against evolving cyber threats.
  
<details>
  <summary><b>STEPS</b></summary>

  1. Analysing the Zeek-ftp.log file in LetsDefend, The Zeek ftp.log entry shows that the client at 192.168.74.100 successfully downloaded a file (delegated-afrinic-extended-latest.md5) from the FTP server at 192.168.74.20 using the RETR command. The transfer was authenticated with the username letsdefend and password ftp@letsdefend.io, and the 74-byte file was retrieved successfully, as indicated by the server's response code 226 ("Transfer complete").

     ![image](https://github.com/user-attachments/assets/8cde7eb4-7da3-41cf-ad0b-5783712f1483)


2. Analyzing the Suricata IPS log file on letsdefend, we can see the command was run successfully based on this screenshot;

   ![image](https://github.com/user-attachments/assets/881ecbbc-ca35-44ee-9c20-86d22db5350f)

   From analyzing these Suricata IPS logs, we can see that the adversary attempted to exploit an SSL vulnerability in the system which is called Poodle

![image](https://github.com/user-attachments/assets/8626fe6a-ec4c-42c6-bebd-150a9b7f0b6d)


<details>
  <sumary><b>FIREWALL</b></sumary>

   Analyzing these firewall logs (Fortinet Firewall), we can see the action taken was denied. At 07:30:52, the firewall named LETSDEFEND blocked an IMAP traffic attempt from 192.168.68.12 (WAN interface) to 192.168.68.34 (Port 143). The traffic was denied due to the absence of a matching policy (policyid=0) and was classified as low risk with no data packets or bytes transmitted. The source and destination were both located within the United States, and the application traffic was categorized as unscanned.

 ![image](https://github.com/user-attachments/assets/1b94e538-0510-440e-8a2d-ce025d0977c5)

 <b>ENDPOINT DETECTION RESPONSE</b>

<b>WEB APPLICATION FIREWALL</b>

 ![image](https://github.com/user-attachments/assets/e6c9562d-517d-46d6-ae62-ccd879adffaa)

 The AWS WAF log shows a blocked SQL Injection (SQLi) attack originating from the IP 185.220.101.35 (Germany). The attacker injected the payload "10 AND 1=1" into the custom HTTP header x-spl-test, likely using the curl tool. The attack targeted the URI /myUri via a GET request.

The LetsDefend_SQLi rule identified the SQLi attempt with high sensitivity and successfully blocked it, ensuring no further impact on the application. This indicates effective protection against SQLi attacks.

### Steps To Take;
- Monitor and block the IP for future activities.
- Review and secure application inputs to prevent SQLi.
- Keep WAF rules updated for ongoing protection.

 <b>CLOUDFLARE</b>

The firewall log indicates a blocked HTTP GET request targeting letsdefend.io from the IP 185.220.102.244, originating from ASN 60533. The request used HTTP/1.0 and a common browser user-agent but lacked a query string, suggesting a generic probe or scan. It was blocked by a custom firewall rule (Rule ID: 8b16d6292f3f4e0096fc85c1ad199sa2).


 ![image](https://github.com/user-attachments/assets/e87a4b42-2e0a-4eeb-972b-1f4cf223cc16)

 </details> 



